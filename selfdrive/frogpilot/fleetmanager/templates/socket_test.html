{% extends "layout.html" %}

{% block title %}
    Socket Test
{% endblock %}

{% block main %}
<div id="message-container"></div>

<script>
    const socket = new WebSocket("ws://localhost:8765");

    // Event listener for when the connection is established
    socket.onopen = event => {
        console.log("WebSocket connection opened");
    };

    // Event listener for incoming messages
    socket.onmessage = event => {
        const receivedMessage = event.data;

        // Display the received message on the webpage
        const messageContainer = document.getElementById("message-container");
        messageContainer.innerHTML = receivedMessage;
    };

    // Event listener for connection close
    socket.onclose = event => {
        if (event.wasClean) {
            console.log(`WebSocket connection closed cleanly, code=${event.code}, reason=${event.reason}`);
        } else {
            console.error("WebSocket connection abruptly closed");
        }
    };

    // Event listener for errors
    socket.onerror = event => {
        console.error("WebSocket error:", event);
    };
</script>
{% endblock %}
